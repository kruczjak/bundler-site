- primary_commands = %w(bundle_install bundle_update bundle_package bundle_exec bundle_config bundle_help)

~ wrap_layout :base do
  .row.bg-light-blue.header
    = image_tag '/images/docs_header_transparent_bg.png',
      srcset: '/images/docs_header_transparent_bg.png 1x, /images/docs_header_transparent_bg@2x.png 2x, /images/docs_header_transparent_bg@3x.png 3x',
      class: 'img-responsive header-padding',
      style: 'max-width: 400px;'
  .row
    .container
      #wrapper
        #sidebar-wrapper
          .sidebar-nav
            %h4 Choose version:
            .form-group
              %select#version-select.form-control
                - versions.reverse.each do |version|
                  %option{selected: version == current_visible_version,
                          value: documentation_path(current_page_without_version, version) || documentation_path('bundle_install', version)}
                    = version
            %h4 Primary Commands
            %ul
              - primary_commands.select{ |page| path_exist?(page, current_visible_version) }.each do |page|
                %li{class: current_page.url[-(page.size+5)..-6] == page ? 'active' : ''}
                  = link_to_documentation(page, current_visible_version)
                %li.separator
                  %hr
            %h4 Utilities
            %ul
              - other_commands(primary_commands, current_visible_version).each do |page|
                %li{class: current_page.url[-(page.size+5)..-6] == page ? 'active' : ''}
                  = link_to_documentation(page, current_visible_version)
                %li.separator
                  %hr
        #page-content-wrapper.commands
          %a.btn.btn-primary.btn-sm.visible-xs-inline#menu-toggle{href: '#'}
            <- Toggle Menu
          ~ yield
        .clearfix
  :javascript
    $('#menu-toggle').click(function(e) {
        e.preventDefault();
        $('#wrapper').toggleClass('toggled');
    });
    $('#version-select').change(function(e) {
      document.location.href = $(e.target).find(":selected").val();
    });